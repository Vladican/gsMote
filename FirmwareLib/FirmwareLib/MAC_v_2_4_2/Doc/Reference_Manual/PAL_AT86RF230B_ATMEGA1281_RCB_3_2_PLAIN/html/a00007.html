<!$Id: atmel-header.html 19278 2009-11-23 09:15:44Z sschneid $>
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
  <title>AVR2025: IEEE 802.15.4 MAC Reference Manual</title>
  <link href="doxygen.css" rel="stylesheet" type="text/css">
</head>
<body>

<table width="100%" height="10%" bgcolor="#FFFFFF">
  <tr>
    <td colspan="2"><p><A href=http://www.atmel.com ><img src="../..//graphics//atmel.jpg"/ border=0></A></p><br /></td>
    <td colspan="2"> <strong><font face="Helvetica" color="#000000" size="+3">Microcontroller Wireless Solutions</font></strong></td>
    <td colspan="2"><p><A href=http://www.atmel.com/products/AVR><img src="../..//graphics//AVR_logo_blue.gif"/ border=0></A></p><br /></td>
  </tr>
  <tr>
    <td colspan="6" height="1" background="../..//graphics//blue.gif"></td>
  </tr>
</table>
<!-- Generated by Doxygen 1.5.6 -->
<div class="contents">
<h1>pal_timer.c File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
Timer related functions for AVR 8-Bit MCUs. 
<p>
This file implements timer related functions for AVR 8-Bit MCUs.<p>
<dl class="rcs" compact><dt><b>Id</b></dt><dd><a class="el" href="a00007.html" title="Timer related functions for AVR 8-Bit MCUs.">pal_timer.c</a> 20047 2010-01-28 11:59:48Z sschneid </dd></dl>
<p>
<dl class="author" compact><dt><b>Author:</b></dt><dd>Atmel Corporation: <a href="http://www.atmel.com">http://www.atmel.com</a> <p>
Support email: <a href="mailto:avr@atmel.com">avr@atmel.com</a> </dd></dl>

<p>Definition in file <a class="el" href="a00018.html">pal_timer.c</a>.</p>

<p>

<p>
<a href="a00018.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00007.html#f92c4c2b0695e9d30e113b0c9843b257">compare_time</a> (uint32_t t1, uint32_t t2)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00007.html#cf6ec90aab03c80c146f6f6b2b37c61a">gettime</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00007.html#8caac840e75e6dcae95b474a701d6e88">internal_timer_handler</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00007.html#6d1d7c75f7a7e5fa6efb2cf797b2ca57">pal_get_current_time</a> (uint32_t *current_time)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00007.html#d15d15a4d0ffa89b390fb170d89f446d">pal_is_timer_running</a> (uint8_t timer_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">retval_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00007.html#a40af7acb7cbc8898d85019c9f7ade00">pal_start_high_priority_timer</a> (uint8_t timer_id, uint16_t timer_count, FUNC_PTR timer_cb, void *param_cb)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">retval_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00007.html#7658311cce894ccb2aee2674208e1f6c">pal_stop_high_priority_timer</a> (uint8_t timer_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00007.html#1befdc5edc9e6a9f76895140552c7cba">pal_timer_delay</a> (uint16_t delay)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00007.html#1d6ce37f64ee157533691b4113a8a14e">pal_timer_source_select</a> (<a class="el" href="a00002.html#25d6bb924de15dd14dd48124c30a4174">source_type_t</a> source)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">retval_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00007.html#c1193577fceb4355c4ab1c1da84427ac">pal_timer_start</a> (uint8_t timer_id, uint32_t timer_count, <a class="el" href="a00002.html#759106c47126e1f989c7e1b140b6258f">timeout_type_t</a> timeout_type, FUNC_PTR timer_cb, void *param_cb)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">retval_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00007.html#3275711bd05a3ff991b076a18d0bfbd9">pal_timer_stop</a> (uint8_t timer_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00007.html#ce9cd5d5f41df20ac486a6922745245e">prog_ocr</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00007.html#c50c88ce88e437ae16af9652cecad330">start_absolute_timer</a> (uint8_t timer_id, uint32_t point_in_time, FUNC_PTR handler_cb, void *parameter)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00007.html#e9b180f762f781150187a88c1344e064">TIMER1_COMPA_vect</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00007.html#d9832a52805f0fb8e9bf15beccbec426">TIMER1_COMPB_vect</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00007.html#c80cb02bb2db2a60b3b6eb7dedf3a0c7">TIMER1_OVF_vect</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00007.html#7b8ab79df77b57475a5494f5f81c3bd9">timer_init</a> (void)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00007.html#f8c91ac68f554eeb8191f4dcdcf35ac4">timer_service</a> (void)</td></tr>

</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="f92c4c2b0695e9d30e113b0c9843b257"></a><!-- doxytag: member="pal_timer.c::compare_time" ref="f92c4c2b0695e9d30e113b0c9843b257" args="(uint32_t t1, uint32_t t2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static bool compare_time           </td>
          <td>(</td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>t1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>t2</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Compares two 32-bit time values. 
<p>
This function compares two true 32-bit time values t1 and t2 and returns true if t1 is less than t2.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>t1</em>&nbsp;</td><td>Time </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>t2</em>&nbsp;</td><td>Time</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>true If t1 is less than t2 when MSBs are same, false otherwise. </dd></dl>

<p>Definition at line <a class="el" href="a00018.html#l00100">100</a> of file <a class="el" href="a00018.html">pal_timer.c</a>.</p>

<p>Referenced by <a class="el" href="a00018.html#l00762">prog_ocr()</a>, and <a class="el" href="a00018.html#l00877">start_absolute_timer()</a>.</p>

</div>
</div><p>
<a class="anchor" name="cf6ec90aab03c80c146f6f6b2b37c61a"></a><!-- doxytag: member="pal_timer.c::gettime" ref="cf6ec90aab03c80c146f6f6b2b37c61a" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static uint32_t gettime           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets actual system time. 
<p>
This function is called to get the system time<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Time in microseconds </dd></dl>

<p>Definition at line <a class="el" href="a00018.html#l00733">733</a> of file <a class="el" href="a00018.html">pal_timer.c</a>.</p>

<p>References <a class="el" href="a00011.html#l00045">sys_time</a>.</p>

<p>Referenced by <a class="el" href="a00018.html#l00617">pal_get_current_time()</a>, <a class="el" href="a00018.html#l00200">pal_timer_start()</a>, and <a class="el" href="a00018.html#l00762">prog_ocr()</a>.</p>

</div>
</div><p>
<a class="anchor" name="8caac840e75e6dcae95b474a701d6e88"></a><!-- doxytag: member="pal_timer.c::internal_timer_handler" ref="8caac840e75e6dcae95b474a701d6e88" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void internal_timer_handler           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Internal timer handler. 
<p>
This function checks for expired timers and rearranges the running timer queue head and expired timer queue head and tail if there are any expired timers. 
<p>Definition at line <a class="el" href="a00018.html#l00817">817</a> of file <a class="el" href="a00018.html">pal_timer.c</a>.</p>

<p>References <a class="el" href="a00018.html#l00762">prog_ocr()</a>.</p>

<p>Referenced by <a class="el" href="a00018.html#l00360">pal_timer_stop()</a>, <a class="el" href="a00018.html#l00877">start_absolute_timer()</a>, and <a class="el" href="a00018.html#l00117">timer_service()</a>.</p>

</div>
</div><p>
<a class="anchor" name="6d1d7c75f7a7e5fa6efb2cf797b2ca57"></a><!-- doxytag: member="pal_timer.c::pal_get_current_time" ref="6d1d7c75f7a7e5fa6efb2cf797b2ca57" args="(uint32_t *current_time)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pal_get_current_time           </td>
          <td>(</td>
          <td class="paramtype">uint32_t *&nbsp;</td>
          <td class="paramname"> <em>current_time</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets current time. 
<p>
This function returns the current time.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>current_time</em>&nbsp;</td><td>Current system time </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="a00018.html#l00617">617</a> of file <a class="el" href="a00018.html">pal_timer.c</a>.</p>

<p>References <a class="el" href="a00018.html#l00733">gettime()</a>.</p>

</div>
</div><p>
<a class="anchor" name="d15d15a4d0ffa89b390fb170d89f446d"></a><!-- doxytag: member="pal_timer.c::pal_is_timer_running" ref="d15d15a4d0ffa89b390fb170d89f446d" args="(uint8_t timer_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool pal_is_timer_running           </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>timer_id</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Checks if the timer with the requested timer identifier is running. 
<p>
Checks if the timer of requested timer identifier is running.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>timer_id</em>&nbsp;</td><td>Timer identifier</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><ul>
<li>true if timer with requested timer id is running,</li><li>false otherwise. </li></ul>
</dd></dl>

<p>Definition at line <a class="el" href="a00018.html#l00685">685</a> of file <a class="el" href="a00018.html">pal_timer.c</a>.</p>

</div>
</div><p>
<a class="anchor" name="a40af7acb7cbc8898d85019c9f7ade00"></a><!-- doxytag: member="pal_timer.c::pal_start_high_priority_timer" ref="a40af7acb7cbc8898d85019c9f7ade00" args="(uint8_t timer_id, uint16_t timer_count, FUNC_PTR timer_cb, void *param_cb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">retval_t pal_start_high_priority_timer           </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>timer_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&nbsp;</td>
          <td class="paramname"> <em>timer_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FUNC_PTR&nbsp;</td>
          <td class="paramname"> <em>timer_cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>param_cb</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Starts high priority timer. 
<p>
This function starts a high priority timer for the specified timeout.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>timer_id</em>&nbsp;</td><td>Timer identifier </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timer_count</em>&nbsp;</td><td>Timeout in microseconds </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timer_cb</em>&nbsp;</td><td>Callback handler invoked upon timer expiry </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>param_cb</em>&nbsp;</td><td>Argument for the callback handler</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><ul>
<li><a class="el" href="a00009.html#fc9d7f23dd99f89ef40b343ef0ca34d2898f6f219ddac56862a5c0ccf63e8167">PAL_TMR_INVALID_ID</a> if the identifier is undefined,</li><li><a class="el" href="a00009.html#fc9d7f23dd99f89ef40b343ef0ca34d2f4639e7f4ea46472f951163c2ba1f4ff">MAC_INVALID_PARAMETER</a> if the callback function for this timer is NULL,</li><li><a class="el" href="a00009.html#fc9d7f23dd99f89ef40b343ef0ca34d25cbfa76ab701a27a85d8baf01f45c0b4">PAL_TMR_ALREADY_RUNNING</a> if the timer is already running, or</li><li><a class="el" href="a00009.html#fc9d7f23dd99f89ef40b343ef0ca34d2aa459125b2699291c39a726ed288803f">MAC_SUCCESS</a> if timer is started successfully. </li></ul>
</dd></dl>

<p>Definition at line <a class="el" href="a00018.html#l00285">285</a> of file <a class="el" href="a00018.html">pal_timer.c</a>.</p>

<p>References <a class="el" href="a00016.html#l00294">ENTER_CRITICAL_REGION</a>, <a class="el" href="a00016.html#l00297">LEAVE_CRITICAL_REGION</a>, <a class="el" href="a00020.html#l00058">MAC_INVALID_PARAMETER</a>, <a class="el" href="a00020.html#l00039">MAC_SUCCESS</a>, <a class="el" href="a00020.html#l00046">PAL_TMR_ALREADY_RUNNING</a>, and <a class="el" href="a00020.html#l00048">PAL_TMR_INVALID_ID</a>.</p>

</div>
</div><p>
<a class="anchor" name="7658311cce894ccb2aee2674208e1f6c"></a><!-- doxytag: member="pal_timer.c::pal_stop_high_priority_timer" ref="7658311cce894ccb2aee2674208e1f6c" args="(uint8_t timer_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">retval_t pal_stop_high_priority_timer           </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>timer_id</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Stops a high priority timer. 
<p>
This function stops a high priority timer.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>timer_id</em>&nbsp;</td><td>Timer identifier</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><ul>
<li><a class="el" href="a00009.html#fc9d7f23dd99f89ef40b343ef0ca34d208386dc8dffe75c56c6727034c14523f">PAL_TMR_NOT_RUNNING</a> if the timer id does not match with the high priority timer register, or</li><li><a class="el" href="a00009.html#fc9d7f23dd99f89ef40b343ef0ca34d2aa459125b2699291c39a726ed288803f">MAC_SUCCESS</a> otherwise. </li></ul>
</dd></dl>

<p>Definition at line <a class="el" href="a00018.html#l00522">522</a> of file <a class="el" href="a00018.html">pal_timer.c</a>.</p>

<p>References <a class="el" href="a00016.html#l00294">ENTER_CRITICAL_REGION</a>, <a class="el" href="a00016.html#l00297">LEAVE_CRITICAL_REGION</a>, <a class="el" href="a00020.html#l00039">MAC_SUCCESS</a>, and <a class="el" href="a00020.html#l00047">PAL_TMR_NOT_RUNNING</a>.</p>

</div>
</div><p>
<a class="anchor" name="1befdc5edc9e6a9f76895140552c7cba"></a><!-- doxytag: member="pal_timer.c::pal_timer_delay" ref="1befdc5edc9e6a9f76895140552c7cba" args="(uint16_t delay)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pal_timer_delay           </td>
          <td>(</td>
          <td class="paramtype">uint16_t&nbsp;</td>
          <td class="paramname"> <em>delay</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Performes blocking delay. 
<p>
Generates blocking delay.<p>
This functions performs a blocking delay of the specified time.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>delay</em>&nbsp;</td><td>in microseconds </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="a00018.html#l00631">631</a> of file <a class="el" href="a00018.html">pal_timer.c</a>.</p>

<p>References <a class="el" href="a00016.html#l00294">ENTER_CRITICAL_REGION</a>, <a class="el" href="a00016.html#l00297">LEAVE_CRITICAL_REGION</a>, and <a class="el" href="a00016.html#l00438">MIN_DELAY_VAL</a>.</p>

<p>Referenced by <a class="el" href="a00011.html#l00187">pal_alert()</a>.</p>

</div>
</div><p>
<a class="anchor" name="1d6ce37f64ee157533691b4113a8a14e"></a><!-- doxytag: member="pal_timer.c::pal_timer_source_select" ref="1d6ce37f64ee157533691b4113a8a14e" args="(source_type_t source)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pal_timer_source_select           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="a00002.html#25d6bb924de15dd14dd48124c30a4174">source_type_t</a>&nbsp;</td>
          <td class="paramname"> <em>source</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Selects timer clock source. 
<p>
This function selects the clock source of the timer.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>source</em>&nbsp;</td><td><ul>
<li><a class="el" href="a00002.html#a6446bfa087f4f4151153c22fee74999bec1cd89a5bb9526defd6225a9e319e1">TMR_CLK_SRC_DURING_TRX_SLEEP</a> if clock source during sleep is to be selected, and</li><li><a class="el" href="a00002.html#a6446bfa087f4f4151153c22fee74999850a5455e0dc6ef5a081d741755a64c6">TMR_CLK_SRC_DURING_TRX_AWAKE</a> if clock source while being awake is selected. </li></ul>
</td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="a00018.html#l00596">596</a> of file <a class="el" href="a00018.html">pal_timer.c</a>.</p>

<p>References <a class="el" href="a00016.html#l00444">TIMER_SRC_DURING_TRX_AWAKE</a>, <a class="el" href="a00016.html#l00452">TIMER_SRC_DURING_TRX_SLEEP</a>, and <a class="el" href="a00013.html#l00121">TMR_CLK_SRC_DURING_TRX_SLEEP</a>.</p>

</div>
</div><p>
<a class="anchor" name="c1193577fceb4355c4ab1c1da84427ac"></a><!-- doxytag: member="pal_timer.c::pal_timer_start" ref="c1193577fceb4355c4ab1c1da84427ac" args="(uint8_t timer_id, uint32_t timer_count, timeout_type_t timeout_type, FUNC_PTR timer_cb, void *param_cb)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">retval_t pal_timer_start           </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>timer_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>timer_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="a00002.html#759106c47126e1f989c7e1b140b6258f">timeout_type_t</a>&nbsp;</td>
          <td class="paramname"> <em>timeout_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FUNC_PTR&nbsp;</td>
          <td class="paramname"> <em>timer_cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>param_cb</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Starts regular timer. 
<p>
Start regular timer.<p>
This function starts a regular timer and registers the corresponding callback function to handle the timeout event.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>timer_id</em>&nbsp;</td><td>Timer identifier </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timer_count</em>&nbsp;</td><td>Timeout in microseconds </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timeout_type</em>&nbsp;</td><td><a class="el" href="a00002.html#9bee3fa507802eec2c8f6ceeb0c49ea9734599f0467ada87fd6fdeef14027807">TIMEOUT_RELATIVE</a> / <a class="el" href="a00002.html#9bee3fa507802eec2c8f6ceeb0c49ea9cbb61438d427d222eaf4ca6cd3ce5494">TIMEOUT_ABSOLUTE</a> </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>timer_cb</em>&nbsp;</td><td>Callback handler invoked upon timer expiry </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>param_cb</em>&nbsp;</td><td>Argument for the callback handler</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><ul>
<li><a class="el" href="a00009.html#fc9d7f23dd99f89ef40b343ef0ca34d2898f6f219ddac56862a5c0ccf63e8167">PAL_TMR_INVALID_ID</a> if the timer identifier is undefined,</li><li><a class="el" href="a00009.html#fc9d7f23dd99f89ef40b343ef0ca34d2f4639e7f4ea46472f951163c2ba1f4ff">MAC_INVALID_PARAMETER</a> if the callback function for this timer is NULL or timeout_type is invalid,</li><li><a class="el" href="a00009.html#fc9d7f23dd99f89ef40b343ef0ca34d25cbfa76ab701a27a85d8baf01f45c0b4">PAL_TMR_ALREADY_RUNNING</a> if the timer is already running,</li><li><a class="el" href="a00009.html#fc9d7f23dd99f89ef40b343ef0ca34d2aa459125b2699291c39a726ed288803f">MAC_SUCCESS</a> if timer is started, or</li><li><a class="el" href="a00009.html#fc9d7f23dd99f89ef40b343ef0ca34d2a6e521fae016ae600525d3e7f795da63">PAL_TMR_INVALID_TIMEOUT</a> if timeout is not within the timeout range. </li></ul>
</dd></dl>

<p>Definition at line <a class="el" href="a00018.html#l00200">200</a> of file <a class="el" href="a00018.html">pal_timer.c</a>.</p>

<p>References <a class="el" href="a00013.html#l00045">ADD_TIME</a>, <a class="el" href="a00018.html#l00733">gettime()</a>, <a class="el" href="a00020.html#l00058">MAC_INVALID_PARAMETER</a>, <a class="el" href="a00020.html#l00039">MAC_SUCCESS</a>, <a class="el" href="a00016.html#l00435">MAX_TIMEOUT</a>, <a class="el" href="a00016.html#l00432">MIN_TIMEOUT</a>, <a class="el" href="a00020.html#l00046">PAL_TMR_ALREADY_RUNNING</a>, <a class="el" href="a00020.html#l00048">PAL_TMR_INVALID_ID</a>, <a class="el" href="a00020.html#l00049">PAL_TMR_INVALID_TIMEOUT</a>, <a class="el" href="a00018.html#l00877">start_absolute_timer()</a>, <a class="el" href="a00013.html#l00050">SUB_TIME</a>, <a class="el" href="a00013.html#l00111">TIMEOUT_ABSOLUTE</a>, and <a class="el" href="a00013.html#l00109">TIMEOUT_RELATIVE</a>.</p>

</div>
</div><p>
<a class="anchor" name="3275711bd05a3ff991b076a18d0bfbd9"></a><!-- doxytag: member="pal_timer.c::pal_timer_stop" ref="3275711bd05a3ff991b076a18d0bfbd9" args="(uint8_t timer_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">retval_t pal_timer_stop           </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>timer_id</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Stops a running timer. 
<p>
This function stops a running timer with the specified timer_id.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>timer_id</em>&nbsp;</td><td>Timer identifier</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd><ul>
<li><a class="el" href="a00009.html#fc9d7f23dd99f89ef40b343ef0ca34d2aa459125b2699291c39a726ed288803f">MAC_SUCCESS</a> if the timer was stopped successfully,</li><li><a class="el" href="a00009.html#fc9d7f23dd99f89ef40b343ef0ca34d208386dc8dffe75c56c6727034c14523f">PAL_TMR_NOT_RUNNING</a> if the specified timer is not running,</li><li><a class="el" href="a00009.html#fc9d7f23dd99f89ef40b343ef0ca34d2898f6f219ddac56862a5c0ccf63e8167">PAL_TMR_INVALID_ID</a> if the specified timer id is undefined. </li></ul>
</dd></dl>

<p>Definition at line <a class="el" href="a00018.html#l00360">360</a> of file <a class="el" href="a00018.html">pal_timer.c</a>.</p>

<p>References <a class="el" href="a00016.html#l00294">ENTER_CRITICAL_REGION</a>, <a class="el" href="a00018.html#l00817">internal_timer_handler()</a>, <a class="el" href="a00016.html#l00297">LEAVE_CRITICAL_REGION</a>, <a class="el" href="a00020.html#l00039">MAC_SUCCESS</a>, <a class="el" href="a00020.html#l00048">PAL_TMR_INVALID_ID</a>, <a class="el" href="a00020.html#l00047">PAL_TMR_NOT_RUNNING</a>, and <a class="el" href="a00018.html#l00762">prog_ocr()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ce9cd5d5f41df20ac486a6922745245e"></a><!-- doxytag: member="pal_timer.c::prog_ocr" ref="ce9cd5d5f41df20ac486a6922745245e" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void prog_ocr           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Programs the output compare register OCR1A. 
<p>
This function programs the OCR1A register with the timeout value of the timer present at the head of the running timer queue. 
<p>Definition at line <a class="el" href="a00018.html#l00762">762</a> of file <a class="el" href="a00018.html">pal_timer.c</a>.</p>

<p>References <a class="el" href="a00018.html#l00100">compare_time()</a>, <a class="el" href="a00016.html#l00294">ENTER_CRITICAL_REGION</a>, <a class="el" href="a00018.html#l00733">gettime()</a>, <a class="el" href="a00016.html#l00297">LEAVE_CRITICAL_REGION</a>, and <a class="el" href="a00011.html#l00045">sys_time</a>.</p>

<p>Referenced by <a class="el" href="a00018.html#l00817">internal_timer_handler()</a>, <a class="el" href="a00018.html#l00360">pal_timer_stop()</a>, and <a class="el" href="a00018.html#l00877">start_absolute_timer()</a>.</p>

</div>
</div><p>
<a class="anchor" name="c50c88ce88e437ae16af9652cecad330"></a><!-- doxytag: member="pal_timer.c::start_absolute_timer" ref="c50c88ce88e437ae16af9652cecad330" args="(uint8_t timer_id, uint32_t point_in_time, FUNC_PTR handler_cb, void *parameter)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void start_absolute_timer           </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>timer_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>point_in_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">FUNC_PTR&nbsp;</td>
          <td class="paramname"> <em>handler_cb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>parameter</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Start a timer by setting its absolute expiration time. 
<p>
This function starts a timer which should expire at the point_in_time value and upon timer expiry the function held by the handler is called.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>timer_id</em>&nbsp;</td><td>Timer identifier </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>point_in_time</em>&nbsp;</td><td>Absolute expiration time in microseconds </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>handler_cb</em>&nbsp;</td><td>Function called upon timer expiry </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>parameter</em>&nbsp;</td><td>Parameter passed to the expired timer handler </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="a00018.html#l00877">877</a> of file <a class="el" href="a00018.html">pal_timer.c</a>.</p>

<p>References <a class="el" href="a00018.html#l00100">compare_time()</a>, <a class="el" href="a00016.html#l00294">ENTER_CRITICAL_REGION</a>, <a class="el" href="a00018.html#l00817">internal_timer_handler()</a>, <a class="el" href="a00016.html#l00297">LEAVE_CRITICAL_REGION</a>, and <a class="el" href="a00018.html#l00762">prog_ocr()</a>.</p>

<p>Referenced by <a class="el" href="a00018.html#l00200">pal_timer_start()</a>.</p>

</div>
</div><p>
<a class="anchor" name="e9b180f762f781150187a88c1344e064"></a><!-- doxytag: member="pal_timer.c::TIMER1_COMPA_vect" ref="e9b180f762f781150187a88c1344e064" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TIMER1_COMPA_vect           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Timer1 COMPA ISR. 
<p>
This is the interrupt service routine for timer1 output compare match. It is triggered when a timer expires. 
</div>
</div><p>
<a class="anchor" name="d9832a52805f0fb8e9bf15beccbec426"></a><!-- doxytag: member="pal_timer.c::TIMER1_COMPB_vect" ref="d9832a52805f0fb8e9bf15beccbec426" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TIMER1_COMPB_vect           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
ISR for high priority timer, triggered by OCR1B. 
<p>
This is the interrupt service routine for timer1.OCR1B output compare match. It is triggered when a high priority timer expires. 
</div>
</div><p>
<a class="anchor" name="c80cb02bb2db2a60b3b6eb7dedf3a0c7"></a><!-- doxytag: member="pal_timer.c::TIMER1_OVF_vect" ref="c80cb02bb2db2a60b3b6eb7dedf3a0c7" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void TIMER1_OVF_vect           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Timer Overflow ISR. 
<p>
This is the interrupt service routine for timer1 overflow. It is triggered every 65536 * 8 us, if clk to timer is 1MHz. The software portion of the system timer is incremented now. 
</div>
</div><p>
<a class="anchor" name="7b8ab79df77b57475a5494f5f81c3bd9"></a><!-- doxytag: member="pal_timer.c::timer_init" ref="7b8ab79df77b57475a5494f5f81c3bd9" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void timer_init           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This function is called to initialize the timer module. 
<p>Definition at line <a class="el" href="a00018.html#l00554">554</a> of file <a class="el" href="a00018.html">pal_timer.c</a>.</p>

<p>References <a class="el" href="a00011.html#l00045">sys_time</a>, and <a class="el" href="a00015.html#l00237">timer_init_non_generic()</a>.</p>

<p>Referenced by <a class="el" href="a00011.html#l00062">pal_init()</a>.</p>

</div>
</div><p>
<a class="anchor" name="f8c91ac68f554eeb8191f4dcdcf35ac4"></a><!-- doxytag: member="pal_timer.c::timer_service" ref="f8c91ac68f554eeb8191f4dcdcf35ac4" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void timer_service           </td>
          <td>(</td>
          <td class="paramtype">void&nbsp;</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Timer handling services. 
<p>
This Function performs timer handling services. It calls functions which are responsible 1) to put the expired timer into the expired timer queue, and 2) to service expired timers and call the respective callback. 
<p>Definition at line <a class="el" href="a00018.html#l00117">117</a> of file <a class="el" href="a00018.html">pal_timer.c</a>.</p>

<p>References <a class="el" href="a00016.html#l00294">ENTER_CRITICAL_REGION</a>, <a class="el" href="a00018.html#l00817">internal_timer_handler()</a>, and <a class="el" href="a00016.html#l00297">LEAVE_CRITICAL_REGION</a>.</p>

<p>Referenced by <a class="el" href="a00011.html#l00079">pal_task()</a>.</p>

</div>
</div><p>
</div>
<!$Id: atmel-footer.html 19276 2009-11-23 09:04:48Z sschneid $>
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
  <title>@DOC_TITLE@</title>
  <link href="doxygen.css" rel="stylesheet" type="text/css">
</head>
<body>

<table width="100%" height="10%" bgcolor="#FFFFFF">
  <tr>
    <td colspan="6" height="1" background="..//img//blue.gif"></td>
  </tr>

  <tr>
    <td colspan="6">
    <address style="align: right;"><small>
Generated on Wed Feb 10 14:33:20 2010 for Platform Reference Manual - (Plain) Radio Controller board RCB230 V3.2 with ATmega1281 and AT86RF230 by <a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border=0></a> 1.5.6</small></address>
    </td>
  </tr>

</table>
