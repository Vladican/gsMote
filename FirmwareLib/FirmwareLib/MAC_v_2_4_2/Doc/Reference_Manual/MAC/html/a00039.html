<!$Id: atmel-header.html 19278 2009-11-23 09:15:44Z sschneid $>
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
  <title>AVR2025: IEEE 802.15.4 MAC Reference Manual</title>
  <link href="doxygen.css" rel="stylesheet" type="text/css">
</head>
<body>

<table width="100%" height="10%" bgcolor="#FFFFFF">
  <tr>
    <td colspan="2"><p><A href=http://www.atmel.com ><img src="../..//graphics//atmel.jpg"/ border=0></A></p><br /></td>
    <td colspan="2"> <strong><font face="Helvetica" color="#000000" size="+3">Microcontroller Wireless Solutions</font></strong></td>
    <td colspan="2"><p><A href=http://www.atmel.com/products/AVR><img src="../..//graphics//AVR_logo_blue.gif"/ border=0></A></p><br /></td>
  </tr>
  <tr>
    <td colspan="6" height="1" background="../..//graphics//blue.gif"></td>
  </tr>
</table>
<!-- Generated by Doxygen 1.5.6 -->
<h1>stb.h</h1><a href="a00016.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 
<a name="l00016"></a>00016 <span class="comment">/*</span>
<a name="l00017"></a>00017 <span class="comment"> * Copyright (c) 2009, Atmel Corporation All rights reserved.</span>
<a name="l00018"></a>00018 <span class="comment"> *</span>
<a name="l00019"></a>00019 <span class="comment"> * Licensed under Atmel's Limited License Agreement --&gt; EULA.txt</span>
<a name="l00020"></a>00020 <span class="comment"> */</span>
<a name="l00021"></a>00021 
<a name="l00022"></a>00022 <span class="comment">/* Prevent double inclusion */</span>
<a name="l00023"></a>00023 <span class="preprocessor">#ifndef STB_H</span>
<a name="l00024"></a>00024 <span class="preprocessor"></span><span class="preprocessor">#define STB_H</span>
<a name="l00025"></a>00025 <span class="preprocessor"></span>
<a name="l00026"></a>00026 <span class="preprocessor">#if defined(STB_ON_SAL) || defined(STB_ARMCRYPTO) || defined(DOXYGEN)</span>
<a name="l00027"></a>00027 <span class="preprocessor"></span>
<a name="l00028"></a>00028 <span class="comment">/* === Includes =========================================================== */</span>
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="preprocessor">#ifdef STB_ON_SAL</span>
<a name="l00031"></a>00031 <span class="preprocessor"></span><span class="preprocessor">#include "<a class="code" href="a00015.html" title="Declarations for low-level security API.">sal.h</a>"</span>
<a name="l00032"></a>00032 <span class="preprocessor">#elif STB_ARMCRYPTO</span>
<a name="l00033"></a>00033 <span class="preprocessor"></span><span class="preprocessor">#include "stb_armcrypto.h"</span>
<a name="l00034"></a>00034 <span class="preprocessor">#else</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span><span class="preprocessor">#error "Unknown STB type"</span>
<a name="l00036"></a>00036 <span class="preprocessor"></span><span class="preprocessor">#endif</span>
<a name="l00037"></a>00037 <span class="preprocessor"></span>
<a name="l00038"></a>00038 <span class="comment">/* === Macros ============================================================= */</span>
<a name="l00039"></a>00039 
<a name="l00040"></a>00040 <span class="comment">/*</span>
<a name="l00041"></a>00041 <span class="comment"> * The following defines are taken from the ZigBee specification and can be</span>
<a name="l00042"></a>00042 <span class="comment"> * to implement ZigBee security.</span>
<a name="l00043"></a>00043 <span class="comment"> */</span>
<a name="l00047"></a><a class="code" href="a00016.html#cdcb9130ee1fd8a1e16a9b5631fa6bc8">00047</a> <span class="preprocessor">#define FRM_COUNTER_LEN                 (4)</span>
<a name="l00048"></a>00048 <span class="preprocessor"></span>
<a name="l00052"></a><a class="code" href="a00016.html#0608a0ceb185981494d41a38b6a1101a">00052</a> <span class="preprocessor">#define MSDU_POS_SEC_CTRL               (1)</span>
<a name="l00053"></a>00053 <span class="preprocessor"></span>
<a name="l00056"></a><a class="code" href="a00016.html#0c374eabfbdbc82a63112e6331870726">00056</a> <span class="preprocessor">#define MSDU_POS_FRM_CNTR               (2)</span>
<a name="l00057"></a>00057 <span class="preprocessor"></span>
<a name="l00060"></a><a class="code" href="a00016.html#78a1034ea6733fa01a53c2e7cbf867d6">00060</a> <span class="preprocessor">#define MSDU_POS_SRC_ADDR               (6)</span>
<a name="l00061"></a>00061 <span class="preprocessor"></span>
<a name="l00064"></a><a class="code" href="a00016.html#d517881dafa96f4639c75858d45abe78">00064</a> <span class="preprocessor">#define MSDU_POS_KEY_SEQ_NO             (14)</span>
<a name="l00065"></a>00065 <span class="preprocessor"></span>
<a name="l00069"></a><a class="code" href="a00016.html#e6b36d87f629ded9185f87e7d5fa4622">00069</a> <span class="preprocessor">#define NONCE_POS_SEC_CTRL              (13)</span>
<a name="l00070"></a>00070 <span class="preprocessor"></span>
<a name="l00071"></a>00071 <span class="comment">/*</span>
<a name="l00072"></a>00072 <span class="comment"> * Definition of Security Control Field:</span>
<a name="l00073"></a>00073 <span class="comment"> *</span>
<a name="l00074"></a>00074 <span class="comment"> * Bit 0-2: Security Level = 6 (MIC length 8 bytes, encryption)</span>
<a name="l00075"></a>00075 <span class="comment"> * Bit 3-4: Key identifier - A Network key</span>
<a name="l00076"></a>00076 <span class="comment"> * Bit 5:   Extended Nonce enabled</span>
<a name="l00077"></a>00077 <span class="comment"> * Bit 6-7: Reserved</span>
<a name="l00078"></a>00078 <span class="comment"> */</span>
<a name="l00082"></a><a class="code" href="a00016.html#492bf528b6cbd18d1a6c5f2c492c5a37">00082</a> <span class="preprocessor">#define SEC_CTRL_POS_SEC_LEVEL          (0)</span>
<a name="l00083"></a>00083 <span class="preprocessor"></span>
<a name="l00086"></a><a class="code" href="a00016.html#c93c924c07365b74fcfd773360ca04bf">00086</a> <span class="preprocessor">#define SEC_CTRL_POS_KEY_ID             (3)</span>
<a name="l00087"></a>00087 <span class="preprocessor"></span>
<a name="l00090"></a><a class="code" href="a00016.html#722a75808a70ae05d6c4e6b0bbd01c67">00090</a> <span class="preprocessor">#define SEC_CTRL_POS_EXT_NONCE          (5)</span>
<a name="l00091"></a>00091 <span class="preprocessor"></span>
<a name="l00092"></a>00092 <span class="comment">/*</span>
<a name="l00093"></a>00093 <span class="comment"> * Definition of Key Identifier Sub-field of Security Control Field:</span>
<a name="l00094"></a>00094 <span class="comment"> *</span>
<a name="l00095"></a>00095 <span class="comment"> * 0x00: A Data key</span>
<a name="l00096"></a>00096 <span class="comment"> * 0x01: A Network key</span>
<a name="l00097"></a>00097 <span class="comment"> * 0x01: A Key-transport key</span>
<a name="l00098"></a>00098 <span class="comment"> * 0x01: A Key-load key</span>
<a name="l00099"></a>00099 <span class="comment"> */</span>
<a name="l00103"></a><a class="code" href="a00016.html#dfe442da3d69c903fc6f1218860dff88">00103</a> <span class="preprocessor">#define KEY_ID_DATA_KEY                 (0x00)</span>
<a name="l00104"></a>00104 <span class="preprocessor"></span>
<a name="l00107"></a><a class="code" href="a00016.html#f23e301e4937b9eab855e46adc5b05eb">00107</a> <span class="preprocessor">#define KEY_ID_NWK_KEY                  (0x01)</span>
<a name="l00108"></a>00108 <span class="preprocessor"></span>
<a name="l00111"></a><a class="code" href="a00016.html#57f09dab7dd7f37f6b98ef66a6f82074">00111</a> <span class="preprocessor">#define KEY_ID_KEY_TRANSPORT_KEY        (0x02)</span>
<a name="l00112"></a>00112 <span class="preprocessor"></span>
<a name="l00115"></a><a class="code" href="a00016.html#fb4c33117a0c7398f46e783f168d2598">00115</a> <span class="preprocessor">#define KEY_ID_KEY_LOAD_KEY             (0x03)</span>
<a name="l00116"></a>00116 <span class="preprocessor"></span>
<a name="l00120"></a>00120 <span class="comment">/*</span>
<a name="l00121"></a>00121 <span class="comment"> * Format:</span>
<a name="l00122"></a>00122 <span class="comment"> * Securiy Control: 0/1 octets</span>
<a name="l00123"></a>00123 <span class="comment"> * Frame Counter: 4 octets</span>
<a name="l00124"></a>00124 <span class="comment"> * Source Address 0/8 octets</span>
<a name="l00125"></a>00125 <span class="comment"> * Key Sequence Number: 0/1 octet</span>
<a name="l00126"></a>00126 <span class="comment"> */</span>
<a name="l00127"></a><a class="code" href="a00016.html#c8ee776615f874c70ac6557f4ef63ebb">00127</a> <span class="preprocessor">#define AUX_HDR_LEN                     (MSDU_POS_KEY_SEQ_NO)</span>
<a name="l00128"></a>00128 <span class="preprocessor"></span>
<a name="l00129"></a>00129 <span class="comment">/* === Types ============================================================== */</span>
<a name="l00130"></a>00130 
<a name="l00134"></a><a class="code" href="a00016.html#fc9d7f23dd99f89ef40b343ef0ca34d2">00134</a> <span class="keyword">typedef</span> <span class="keyword">enum</span>
<a name="l00135"></a>00135 {
<a name="l00137"></a><a class="code" href="a00016.html#fc9d7f23dd99f89ef40b343ef0ca34d2b69fb7e221e7b40d0490b6acb6ddb068">00137</a>     <a class="code" href="a00016.html#fc9d7f23dd99f89ef40b343ef0ca34d2b69fb7e221e7b40d0490b6acb6ddb068">STB_CCM_OK</a> = 0,
<a name="l00139"></a><a class="code" href="a00016.html#fc9d7f23dd99f89ef40b343ef0ca34d2fc2338d73aa403c996239c51d93f52e2">00139</a>     <a class="code" href="a00016.html#fc9d7f23dd99f89ef40b343ef0ca34d2fc2338d73aa403c996239c51d93f52e2">STB_CCM_ILLPARM</a>,
<a name="l00141"></a><a class="code" href="a00016.html#fc9d7f23dd99f89ef40b343ef0ca34d2534fe384a257e9c368d7b3496166b9de">00141</a>     <a class="code" href="a00016.html#fc9d7f23dd99f89ef40b343ef0ca34d2534fe384a257e9c368d7b3496166b9de">STB_CCM_KEYMISS</a>,
<a name="l00143"></a><a class="code" href="a00016.html#fc9d7f23dd99f89ef40b343ef0ca34d228e4daddccefc756c388a19a7f27f947">00143</a>     <a class="code" href="a00016.html#fc9d7f23dd99f89ef40b343ef0ca34d228e4daddccefc756c388a19a7f27f947">STB_CCM_MICERR</a>
<a name="l00144"></a>00144 } <a class="code" href="a00017.html#fc9d7f23dd99f89ef40b343ef0ca34d2">SHORTENUM</a> stb_ccm_t;
<a name="l00145"></a>00145 
<a name="l00146"></a>00146 <span class="comment">/* === Externals ========================================================== */</span>
<a name="l00147"></a>00147 
<a name="l00148"></a>00148 
<a name="l00149"></a>00149 <span class="comment">/* === Prototypes ========================================================= */</span>
<a name="l00150"></a>00150 
<a name="l00151"></a>00151 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00152"></a>00152 <span class="preprocessor"></span><span class="keyword">extern</span> <span class="stringliteral">"C"</span> {
<a name="l00153"></a>00153 <span class="preprocessor">#endif</span>
<a name="l00154"></a>00154 <span class="preprocessor"></span>
<a name="l00162"></a>00162 <span class="keywordtype">void</span> <a class="code" href="a00026.html#gcfeaa4bc0c07f57a3598aae3667f84db" title="STB Initialization.">stb_init</a>(<span class="keywordtype">void</span>);
<a name="l00163"></a>00163 
<a name="l00171"></a>00171 <span class="keywordtype">void</span> <a class="code" href="a00026.html#g27529aca56f9e0f91eb97f97b12c837e" title="STB Restart.">stb_restart</a>(<span class="keywordtype">void</span>);
<a name="l00172"></a>00172 
<a name="l00201"></a>00201 stb_ccm_t <a class="code" href="a00026.html#g29c5b9b313ee6b15e575bdbe9be0f6dd" title="Secure one block with CCM*.">stb_ccm_secure</a>(uint8_t *buffer,
<a name="l00202"></a>00202                          uint8_t nonce[<a class="code" href="a00015.html#fab0742642db9c0609c00bf8a54f386f">AES_BLOCKSIZE</a>],
<a name="l00203"></a>00203                          uint8_t *key,
<a name="l00204"></a>00204                          uint8_t hdr_len,
<a name="l00205"></a>00205                          uint8_t pld_len,
<a name="l00206"></a>00206                          uint8_t sec_level,
<a name="l00207"></a>00207                          uint8_t aes_dir);
<a name="l00208"></a>00208 
<a name="l00209"></a>00209 <span class="preprocessor">#ifdef __cplusplus</span>
<a name="l00210"></a>00210 <span class="preprocessor"></span>} <span class="comment">/* extern "C" */</span>
<a name="l00211"></a>00211 <span class="preprocessor">#endif</span>
<a name="l00212"></a>00212 <span class="preprocessor"></span>
<a name="l00213"></a>00213 
<a name="l00214"></a>00214 <span class="preprocessor">#endif </span><span class="comment">/* #ifdef STB_ON_SAL */</span>
<a name="l00215"></a>00215 
<a name="l00216"></a>00216 <span class="preprocessor">#endif </span><span class="comment">/* STB_H */</span>
<a name="l00217"></a>00217 <span class="comment">/* EOF */</span>
</pre></div></div>
<!$Id: atmel-footer.html 19276 2009-11-23 09:04:48Z sschneid $>
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
  <title>@DOC_TITLE@</title>
  <link href="doxygen.css" rel="stylesheet" type="text/css">
</head>
<body>

<table width="100%" height="10%" bgcolor="#FFFFFF">
  <tr>
    <td colspan="6" height="1" background="..//img//blue.gif"></td>
  </tr>

  <tr>
    <td colspan="6">
    <address style="align: right;"><small>
Generated on Wed Feb 10 14:33:17 2010 for IEEE 802.15.4-2006 MAC Reference Manual by <a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border=0></a> 1.5.6</small></address>
    </td>
  </tr>

</table>
