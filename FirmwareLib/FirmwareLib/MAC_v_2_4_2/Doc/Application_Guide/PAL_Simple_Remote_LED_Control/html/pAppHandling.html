<!$Id: atmel-header.html 15414 2009-05-08 14:48:39Z sschneid $>
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
  <title>AVR2025: IEEE 802.15.4 MAC Reference Manual</title>
  <link href="doxygen.css" rel="stylesheet" type="text/css">
</head>
<body>

<table width="100%" height="10%" bgcolor="#FFFFFF">
  <tr>
    <td colspan="2"><p><A href=http://www.atmel.com ><img src="..//graphics//atmel.jpg"/ border=0></A></p><br /></td>
    <td colspan="2"> <strong><font face="Helvetica" color="#000000" size="+3">Microcontroller Wireless Solutions</font></strong></td>
    <td colspan="2"><p><A href=http://www.atmel.com/products/AVR><img src="..//graphics//AVR_logo_blue.gif"/ border=0></A></p><br /></td>
  </tr>
  <tr>
    <td colspan="6" height="1" background="..//graphics//blue.gif"></td>
  </tr>
</table>
<!-- Generated by Doxygen 1.5.6 -->
<div class="contents">
<h1><a class="anchor" name="pAppHandling">Application Handling </a></h1>The application is intended to be used with the radio controller boards (RCBs), but since the <a class="el" href="group__apiPalApi.html">PAL API</a> functions are used, it can be easily ported to other platforms. The basic hardware requirements for a platform are: a MCU with a radio transceiver, 1 button and 3 LEDs.<p>
After powering up of the board, the application starts automatically and performs the <a class="el" href="pAppHandling.html#secUIAppInit">initialization</a>. Thereafter, the application is in <a class="el" href="pAppHandling.html#secUIAppTask">Working Phase</a> working mode, where the count of correct received frames is displayed on the LEDs and frames can be transmitted by pressing the button.<h2><a class="anchor" name="secUI">
User Interface</a></h2>
<h3><a class="anchor" name="secUIAppInit">
Initialization Phase</a></h3>
The initialization phase is implemented in function <a class="el" href="group__apiPalAppDemo.html#gdd3190cf715f513666f4be42874d91e2" title="Application initialisation function.">app_init()</a>.<p>
In this phase the <b>Button</b> is not used and the <b>LEDs</b> display the last executed initialization step:<ul>
<li>After initialization of the PAL and registering IRQ handlers.</li><li>After reseting the transceiver</li><li>If transceiver has reached state TRX_OFF for the first time.</li><li>After configuring the transceiver and enabling the transceiver IRQs.</li><li>If transceiver is in state RX_ON and the gloable IRQs are enabled.</li><li>Before entering the <a class="el" href="pAppHandling.html#secUIAppTask">Working Phase</a>.</li></ul>
<p>
<div align="center">
<img src="app_init.gif" alt="app_init.gif">
<p><strong>LED Pattern during initialization</strong></p></div>
 <h3><a class="anchor" name="secUIAppTask">
Working Phase</a></h3>
The working phase is implemented in the functions <a class="el" href="group__apiPalAppDemo.html#gf59e38af599b4376e50df1a516c42587" title="Application task function.">app_task()</a>, <a class="el" href="group__apiPalAppDemo.html#g3385900f94992e560747cdc3d54950cb" title="TX_END IRQ handler.">irq_tx_end_handler()</a> and <a class="el" href="group__apiPalAppDemo.html#g93873354ad6fd915028d366a37128740" title="RX_END IRQ handler.">irq_rx_end_handler()</a>.<p>
If the <b>button</b> is pressed once, one frame is transmitted and if the <b>button</b> is hold, frames are sent continously until the <b>button</b> is released. <b>LED0</b> is toggled everytime when a frame transmission is initiated and completed. So with each transmitted frame LED0 flushes.<p>
<div align="center">
<img src="app_task_tx.gif" alt="app_task_tx.gif">
<p><strong>LED Pattern during frame transmission</strong></p></div>
 While no frame transmission is in progress, the transceiver is in state RX_ON. <b>LED0</b> is toggled if a frame is received. The RX frame counter is incremented and displayed with the <b>LEDs</b> if the CRC and addressing information are correct.<p>
<div align="center">
<img src="app_task_rx.gif" alt="app_task_rx.gif">
<p><strong>LED Pattern during frame reception</strong></p></div>
 <h2><a class="anchor" name="secRF">
RF Handling</a></h2>
The frames transmitted by this application are IEEE 802.15.4 data frames without destination addresses. They have the following format, which corresponds to the C data structure <a class="el" href="structapp__frame__t.html">app_frame_t</a> :<p>
<dl class="user" compact><dt><b>Hexdump of the Frame</b></dt><dd><div class="fragment"><pre class="fragment">      |FCF|SEQ|--- ADDR --|------------------- DATA -
0000  01 80 01 5a 4c 4e 4b 41 54 6d 65 67 61 31 32 38   ...ZLNKATmega128
0010  52 46 41 31 00 02 5f 43                           RFA1.._C
      ------------------|FCF|
</pre></div></dd></dl>
<dl class="user" compact><dt><b>Frame Syntax</b></dt><dd><div class="fragment"><pre class="fragment">PHR:    24 (Frame Length)
FCF:    Frame Control Field: Data (0x8001)
        .... .... .... .001 = Frame Type: Data (0x0001)
        .... .... .... 0... = Security Enabled: False
        .... .... ...0 .... = Frame Pending: False
        .... .... ..0. .... = Acknowledge Request: False
        .... .... .0.. .... = Intra-PAN: False
        .... 00.. .... .... = Destination Addressing Mode: None (0x0000)
        ..00 .... .... .... = Frame Version: 0
        10.. .... .... .... = Source Addressing Mode: Short/16-bit (0x0002)
SEQ:    0x01 = this number is incremented for sent every frame by 1.
ADDR:   Source PAN: 0x4c5a
        Source: 0x4b4e
DATA:   41546D656761313238524641310002
FCS:    0x435f (Correct)
</pre></div></dd></dl>
The application operates per default on the channel <a class="el" href="simple__remote__led__control_8h.html#afa17c307af8c45323500fdac999d294">DEFAULT_CHANNEL</a>. This setting can be changed<ul>
<li>with a make option (see <a class="el" href="pSwBuild.html">Compiling the Software</a>).</li><li>from the compiler command line, e.g. for avr-gcc with option "-DDEFAULT_CHANNEL=17", </li></ul>
</div>
<!$Id: atmel-footer.html 15414 2009-05-08 14:48:39Z sschneid $>
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
  <title>@DOC_TITLE@</title>
  <link href="doxygen.css" rel="stylesheet" type="text/css">
</head>
<body>

<table width="100%" height="10%" bgcolor="#FFFFFF">
  <tr>
    <td colspan="6" height="1" background="..//img//blue.gif"></td>
  </tr>

  <tr>
    <td colspan="6">
    <address style="align: right;"><small>
Generated on Wed Feb 10 14:33:35 2010 for PAL Example Application Simple Remote LED Control by <a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border=0></a> 1.5.6</small></address>
    </td>
  </tr>

</table>
